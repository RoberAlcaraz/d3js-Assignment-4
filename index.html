<!DOCTYPE html>
<html>
    <head>
        <title>d3.js data driven page</title>
        <script src="https://d3js.org/d3.v6.min.js"></script>
        <style>

            #myCanvas {
                background-color: yellow;
            }

            th {
                color: blue;
            }

            .name {
                color: red;
                border: solid black 1pt;
            }

            .name:hover {
                border-width: 2pt;
            }

            .date {
                color: green;
            }
            .date:hover
            {
                font-weight: bold;
            }
        </style>
    </head>

    <body>
        <p>
            <div id="dateSelector"></div>
            <svg id="myCanvas" style="width:100%; height: 200px;"></svg>

            <table>
                <thead></thead>
                <tbody></tbody>
            </table>
        </p>

        <script>
            csv_url = false ? "histogram-data.csv" : "https://raw.githubusercontent.com/RoberAlcaraz/d3js-Assignment-4/main/histogram-data.csv";
            d3.csv(csv_url).then(tidying)

            function updateTable(d) {
                d3.select("table tbody")
                    .selectAll("tr")
                    .data(d)
                    .join("tr")
                    .selectAll("td")
                    .data(e => columns.map(x => e[x]))
                    .join("td")
                        .text(x => x);
            }

            function makeHeader(d) {
                d3.select("table thead").selectAll("tr").remove()

                d3.select("table thead")
                    .append("tr")
                    .selectAll("th")
                    .data(columns)
                    .join("th").text(e => e)
            }

            var data, columns, maxValue;
            function tidying(d) {
                data = d;
                columns = d.columns;
                
                updateTable(data)
                makeHeader(data)

                updateSelect()
            }

            function updateSelect(e) {
                val = d3.select("select").node().value
                fdata = d3.filter(data, d => d.date == val)
                updateTable(fdata)
            }

        </script>
    </body>
</html>